1. Viết Logger chung cho toàn bộ bên ngoài
+ ghi log vào 1 file (mỗi lần restart Pi là 1 file khác nhau, còn restart app thì ko)
+ NÂNG CAO: quá bao nhiêu MB thì qua log mới dù ko restart Pi
+ NÂNG CAO: Giải nén file

2. Unit test dùng gg test (Có CmakeList riêng)
- Cho thằng coremgr là được
- Xài GMOCK + CmakeList cho nó chuẩn chuyên nghiệp.

3. CloudManager

18. GStreamer, Camera, Capture, ... OpenCV...



// --------------------------
Dec 09 23:27:47 raspberrypi hardwaremanager[15677]: dbus[15677]: The last reference on a connection was dropped without closing the connection. This is a bug in an application. See dbus_connection_unref() documentation for details.
Dec 09 23:27:47 raspberrypi hardwaremanager[15677]: Most likely, the application was supposed to call dbus_connection_close(), since this is a private connection.


-------------------------------
1/ Cài đặt và cấu hình oFono
oFono là một daemon cung cấp API D-Bus cấp cao để điều khiển các chức năng telephony (modem, cuộc gọi, SMS, danh bạ).
1.1/ sudo apt-get install ofono
sudo apt-get remove ofono

1.2/Cấp quyền cho oFono: oFono cần quyền để tương tác với BlueZ. Bạn cần chỉnh sửa file cấu hình D-Bus của BlueZ.

Mở file: sudo nano /etc/dbus-1/system.d/bluetooth.conf
Tìm đến phần <policy user="root">. Bên trong đó, thêm một dòng cho phép ofono sở hữu dịch vụ của BlueZ:
<policy user="ofono">
    <allow own="org.bluez"/>
    <allow send_destination="org.bluez"/>
</policy>

sudo nano /lib/systemd/system/bluetooth.service

1.3/ sudo nano /lib/systemd/system/bluetooth.service
ExecStart=/usr/lib/bluetooth/bluetoothd --experimental

1.4/ 
sudo systemctl daemon-reload
sudo systemctl restart bluetooth

sudo systemctl enable ofono
sudo systemctl start ofono

2/ Tương tác với oFono qua D-Bus

Service: org.ofono
org.ofono.Manager: Tại object path /. Dùng để lấy danh sách các "modem" (mỗi thiết bị Bluetooth được kết nối sẽ được xem như một modem).
org.ofono.VoiceCallManager: Tại object path của modem (ví dụ: /bluetooth/XX_XX_XX_XX_XX_XX). Đây là nơi bạn:
  Lắng nghe tín hiệu CallAdded (cuộc gọi đến/đi) và CallRemoved.
  Gọi phương thức GetCalls() để lấy danh sách các cuộc gọi hiện tại.
org.ofono.VoiceCall: Tại object path của cuộc gọi (ví dụ: /bluetooth/XX_XX_XX_XX_XX_XX/call_1). Đây là nơi bạn:
  Lắng nghe tín hiệu PropertyChanged để biết trạng thái cuộc gọi (ringing, active, disconnected).
  Gọi phương thức Answer() để chấp nhận cuộc gọi.
  Gọi phương thức Hangup() để từ chối hoặc kết thúc cuộc gọi.
org.ofono.Phonebook: Tại object path của modem. Dùng để truy cập danh bạ.

3/ Hardwaremanager lắng nghe và gọi các API DBus của oFono